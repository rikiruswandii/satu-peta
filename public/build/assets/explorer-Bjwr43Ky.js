import{ap as v,aq as C,aW as P,aV as I,as as D,at as F}from"./GeoJSON-DjKYdZcq.js";var e=jQuery.noConflict();e(document).ready(function(){const S=e("#sidebar"),T=e("#main-content"),m=e(".toggle-btn, #anotherToggle"),A=e("#toggleSidebar"),M=e("#result-area");e("#search-btn, #close-result-btn").on("click",function(t){t.stopPropagation()}),m.on("click",function(t){e(t.target).is("i")&&(S.toggleClass("closed"),T.toggleClass("shifted"),m.toggleClass("closed"),M.toggleClass("closed"),A.toggleClass("bi-list bi-arrow-bar-right"))});let r=initMap("explorerMapId","",{scale:!0,fullScreen:!0,zoomSlider:!0,basemap:!0,export:!0,draw:!0},{dragPan:!0});e("#layerList").sortable({update:function(){c()}});function c(){let t=[];e("#layerList li").each(function(){let a=e(this).data("layer-id"),o=r.getLayers().getArray().find(s=>s.get("id")===a);o&&t.push(o)}),t.forEach((a,o)=>{a.setZIndex(o)})}let d;function n(){let t=e("#maxLayerAlert");t.removeClass("d-none").addClass("show"),clearTimeout(d),d=setTimeout(()=>{t.addClass("d-none").removeClass("show")},3e3)}e(document).on("click","#maxLayerAlert .close",function(){e("#maxLayerAlert").addClass("d-none").removeClass("show"),clearTimeout(d)});function h(t,a){if(e("#layerList li").length>=10){n();return}let o=`layer-${Date.now()}`;t.set("id",o);let s=`
    <li data-layer-id="${o}" class="list-group-item text-success d-flex justify-content-between align-items-center" style="cursor:pointer;font-size:14px;">
        <div class="d-flex align-items-center gap-2">
            <input type="checkbox" class="is-active" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Checkbox" checked>
            <span>${a}</span>
        </div>
        <div class="d-flex gap-2">
            <i class="bound-to-layer bi bi-aspect-ratio link-secondary" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Pusatkan"></i>
            <i class="remove-layer bi bi-x-circle-fill link-danger" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Hapus"></i>
        </div>
    </li>`;e("#layerList").append(s),e("#layerList [data-bs-toggle='tooltip']").tooltip()}e(".list-group-item a").on("click",function(){let t=e(this).data("geojson"),a=e(this).data("name");if(console.log("GeoJSON Path:",t),!t){n();return}if(e("#layerList li").length>=10){n();return}let o=new v({source:new C({url:t,format:new P}),style:function(s){return getStyle(s)}});r.addLayer(o),h(o,a),c()}),e(document).on("click",'[data-bs-target="#openModalDataset"]',function(){e(".modal-header").css({cursor:"move",color:"white",backgroundColor:"#0fac81"}),e(".modal-title").attr("style","color: #FFC107 !important; font-size: 16px !important;"),e(".modal-content").css({background:"rgba(255, 255, 255, 0.5)","backdrop-filter":"blur(3px)"}),e(".modal-dialog").css({position:"fixed",width:"100%",margin:0,padding:"10px"}),e(".modal.in").length||e(".modal-dialog").css({top:200,left:280}),e("#openModalDataset").modal({backdrop:"static",keyboard:!1,show:!0}),e(".modal-backdrop").remove(),e(".modal-dialog").draggable({handle:".modal-header"}),e("#search-dataset").on("input",function(){let t=e(this).val().toLowerCase(),a=!1;e(".accordion-item").each(function(){let o=e(this).find(".accordion-button").text().trim().toLowerCase(),s=!1;e(this).find(".list-group-item").each(function(){let l=e(this).text().trim().toLowerCase(),i=o.includes(t)||l.includes(t);e(this).toggle(i),i&&(s=!0,a=!0)}),e(this).toggle(s||o.includes(t)),o.includes(t)&&(a=!0)}),a?e("#no-results").addClass("d-none"):e("#no-results").removeClass("d-none")})}),e("#layerList").on("change",".is-active",function(){let t=e(this).closest("li").data("layer-id"),a=r.getLayers().getArray().find(o=>o.get("id")===t);a&&a.setVisible(e(this).is(":checked"))}),e("#layerList").on("click",".bound-to-layer",function(){let t=e(this).closest("li").data("layer-id"),a=r.getLayers().getArray().find(o=>o.get("id")===t);if(a){let o=a.getSource().getExtent();o&&r.getView().fit(o,{duration:500})}}),e("#layerList").on("click",".remove-layer",function(){let t=e(this).closest("li").data("layer-id"),a=r.getLayers().getArray().find(o=>o.get("id")===t);a&&r.removeLayer(a),e(this).closest("li").remove()});function f(){const t=e("#search-from-aside").val().trim();if(!t){console.warn("Query kosong, pencarian dibatalkan.");return}console.log("Mencari lokasi:",t),fetch(`https://photon.komoot.io/api/?q=${encodeURIComponent(t)}&limit=10`).then(a=>{if(!a.ok)throw new Error(`HTTP error! Status: ${a.status}`);return a.json()}).then(a=>{const o=a.features||[],s=e("#search-results");if(s.html(""),!Array.isArray(o)||o.length===0){s.html("<li class='list-group-item text-muted'>Tidak ada hasil ditemukan.</li>");return}e("#result-area").show(),e("#result-area").css({width:"360px",maxWidth:"360px"}),e("#close-result-btn").removeClass("d-none"),e(".toggle-btn").css({width:"300px",maxWidth:"300px"}),o.forEach(l=>{var y,p,b,x,k;const i=((y=l.properties)==null?void 0:y.name)||"Tidak diketahui",u=(b=(p=l.geometry)==null?void 0:p.coordinates)==null?void 0:b[0],g=(k=(x=l.geometry)==null?void 0:x.coordinates)==null?void 0:k[1];if(u===void 0||g===void 0)return;const V=e("<li></li>").addClass("list-group-item text-success").text(i).css({cursor:"pointer"}).on("click",function(){if(e("#layerList li").length>=10){n();return}r.getView().animate({center:I([u,g]),zoom:14,duration:1e3});const L=new C,w=new v({source:L,style:function(E){return getStyle(E)}});r.addLayer(w);const $=new D({geometry:new F(I([u,g])),name:i});L.addFeature($),h(w,i),c()});s.append(V)})}).catch(a=>console.error("Error fetching data:",a))}e("#search-from-aside").on("keypress",function(t){t.key==="Enter"&&(t.preventDefault(),f())}),e("#search-btn").on("click",f),e("#close-result-btn").on("click",function(){e("#result-area").css({width:"330px",maxWidth:"330px"}),e(".toggle-btn").css({width:"270px",maxWidth:"270px"}),e("#result-area").hide(),e("#close-result-btn").addClass("d-none")})});
